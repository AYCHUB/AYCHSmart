{# Fragment that display company sales to be included with a jquery load #}
{# One must include in its extrajs block core/_c3.htm to load according js/css #}
{% load i18n %}


<center><h3>{% if only_last_year %}{% trans "Last year sales repartition" %}{% else %}{% blocktrans %} Client sales repartition since {{ min_date }}{% endblocktrans %}{% endif %}</h3></center>
<div id="company_sales_{{ only_last_year|safe }}"></div>

<script type="text/javascript">
$(document).ready(function() {

    chart_company_sales_{{ only_last_year|safe }} = c3.generate({
        bindto: '#company_sales_{{ only_last_year|safe }}',
        data: {
            columns:  {{ graph_data|safe }},
            type : 'pie'
        },
        pie: {
            label: {
                format: function (value, ratio, id) {
                    return d3.format('.0')(value)+ ' kâ‚¬';
            }
        }
    }
    });

    $('#tab-all-companies').bind('tabsshow', function(event, ui) {
            console.log("coucou");
            chart_company_sales_{{ only_last_year|safe }}.flush();
    });

}); // End of ready()
</script>