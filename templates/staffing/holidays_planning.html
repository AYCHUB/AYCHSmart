{% extends "core/pydici.html" %}

{% load i18n %}

{% block title %}{% trans "Holidays planning" %}{% endblock %}

{% block content %}

<h1>
<ul class="pager" style="text-align:left">
    <li class="pydici-tooltip" title="{% trans 'Previous month' %}"><a href="{% url 'staffing.views.holidays_planning' year=previous_month|date:'Y' month=previous_month|date:'m' %}"><span class="glyphicon glyphicon-chevron-left"></span></a></li>
    {% trans "Holidays planning" %} {{ month|date:"F Y"}}
    <li class="pydici-tooltip" title="{% trans 'Next month' %}"><a href="{% url 'staffing.views.holidays_planning' year=next_month|date:'Y' month=next_month|date:'m' %}"><span class="glyphicon glyphicon-chevron-right"></span></a></li>
</ul>
</h1>

<div class="table-responsive">
<table class="table table-hover table-pydici-extra-condensed">
    <thead>
        <tr><td></td>
        {% for day in days %}
            <th>{{ day|date:"j" }}</th>
        {% endfor %}
        </tr>
        <tr>
        <td></td>
        {% for day in days %}
            <td>{{ day|date:"D" }}</td>
        {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for line in data %}
        <tr>
            {% for item in line %}
                {% if forloop.first %}<td>{{ item }}</td>
                {% else %}<td style='background:{{ item }}'>  </td>{% endif %}
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

<script type="text/javascript">
 function highlight_today(col_number, borderStyle) {
     // Header cell for both table that use and don't use thead
     $(".table-pydici-extra-condensed tr:first td:nth-child(" + col_number + ")").css('border-top', borderStyle);
     $(".table-pydici-extra-condensed tr:first th:nth-child(" + col_number + ")").css('border-top', borderStyle);
     $(".table-pydici-extra-condensed tr:first th:nth-child(" + col_number + ")").css('border-left', borderStyle);
     $(".table-pydici-extra-condensed tr:first th:nth-child(" + col_number + ")").css('border-right', borderStyle);

     // Rows of each mission
     $(".table-pydici-extra-condensed tr td:nth-child(" + col_number + ")").css('border-left', borderStyle);
     $(".table-pydici-extra-condensed tr td:nth-child(" + col_number + ")").css('border-right', borderStyle);

     // Last Row
     $(".table-pydici-extra-condensed tr:last td:nth-child(" + col_number + ")").css('border-bottom', borderStyle);

     // Add a tooltip on headers (for tables that use thead)
     $(".table-pydici-extra-condensed thead tr *:nth-child(" + col_number + ")").prop("title", "{% blocktrans %}Today{% endblocktrans %}");
     // Add a tooltip on headers (for tables that DON'T use thead)
     $(".table-pydici-extra-condensed tr:first td:nth-child(" + col_number + ")").prop("title", "{% blocktrans %}Today{% endblocktrans %}");
 }

 if (0 !== {{ today }}) {
     // First column is consulant's name
     highlight_today({{ today }} + 1, "2px solid #555");
 }
</script>

{% endblock %}
